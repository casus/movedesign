<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Running hierarchical models (with resampling) — run_meta_resamples • movedesign</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Barlow-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Running hierarchical models (with resampling) — run_meta_resamples"><meta name="description" content="This function performs meta-analyses on simulated animal tracking data,
to estimate key movement metrics, such as mean home range area and/or
mean movement speed for a sampled population. The function can also
compare these metrics between two groups if specified.
When resampling is enabled, the function repeatedly draws random
subsets of individuals from the available population to simulate how
parameter estimates behave across varying population sample sizes.
This resampling allows users to assess estimate variability as sample
size increases or as individuals are resampled. For example, it can
reveal if the mean home range area converges as more individuals are
added to the sampled population.
This approach helps quantify the robustness and precision of estimated
parameters under different sampling scenarios.
The function leverages core methods from the ctmm package:
ctmm::akde(): Computes home range areas using the Autocorrelated
Kernel Density Estimator (AKDE), which explicitly accounts for the
autocorrelation in animal movement data to produce statistically
robust space-use estimates.
ctmm::speed(): Computes Continuous-Time Speed and Distance (CTSD)
estimates, providing biologically meaningful summaries of movement
speed, which is proportional to distance traveled.
These methods allow for robust comparisons across individuals,
groups, and resampling scenarios.

"><meta property="og:description" content="This function performs meta-analyses on simulated animal tracking data,
to estimate key movement metrics, such as mean home range area and/or
mean movement speed for a sampled population. The function can also
compare these metrics between two groups if specified.
When resampling is enabled, the function repeatedly draws random
subsets of individuals from the available population to simulate how
parameter estimates behave across varying population sample sizes.
This resampling allows users to assess estimate variability as sample
size increases or as individuals are resampled. For example, it can
reveal if the mean home range area converges as more individuals are
added to the sampled population.
This approach helps quantify the robustness and precision of estimated
parameters under different sampling scenarios.
The function leverages core methods from the ctmm package:
ctmm::akde(): Computes home range areas using the Autocorrelated
Kernel Density Estimator (AKDE), which explicitly accounts for the
autocorrelation in animal movement data to produce statistically
robust space-use estimates.
ctmm::speed(): Computes Continuous-Time Speed and Distance (CTSD)
estimates, providing biologically meaningful summaries of movement
speed, which is proportional to distance traveled.
These methods allow for robust comparisons across individuals,
groups, and resampling scenarios.

"><meta property="og:image" content="https://ecoisilva.github.io/movedesign/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">movedesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/movedesign.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial_ind.html">Walkthrough (single estimate)</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_pop.html">Walkthrough (population-level)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ecoisilva/movedesign" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Running hierarchical models (with resampling)</h1>
      <small class="dont-index">Source: <a href="https://github.com/ecoisilva/movedesign/tree/main/R/fct_meta.R" class="external-link"><code>R/fct_meta.R</code></a></small>
      <div class="d-none name"><code>run_meta_resamples.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs meta-analyses on simulated animal tracking data,
to estimate key movement metrics, such as mean home range area and/or
mean movement speed for a sampled population. The function can also
compare these metrics between two groups if specified.</p>
<p>When resampling is enabled, the function repeatedly draws random
subsets of individuals from the available population to simulate how
parameter estimates behave across varying population sample sizes.
This resampling allows users to assess estimate variability as sample
size increases or as individuals are resampled. For example, it can
reveal if the mean home range area converges as more individuals are
added to the sampled population.</p>
<p>This approach helps quantify the robustness and precision of estimated
parameters under different sampling scenarios.</p>
<p>The function leverages core methods from the <code>ctmm</code> package:</p><ul><li><p><code><a href="https://rdrr.io/pkg/ctmm/man/akde.html" class="external-link">ctmm::akde()</a></code>: Computes home range areas using the Autocorrelated
Kernel Density Estimator (AKDE), which explicitly accounts for the
autocorrelation in animal movement data to produce statistically
robust space-use estimates.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/ctmm/man/speed.html" class="external-link">ctmm::speed()</a></code>: Computes Continuous-Time Speed and Distance (CTSD)
estimates, providing biologically meaningful summaries of movement
speed, which is proportional to distance traveled.
These methods allow for robust comparisons across individuals,
groups, and resampling scenarios.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_meta_resamples</span><span class="op">(</span></span>
<span>  <span class="va">rv</span>,</span>
<span>  set_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hr"</span>, <span class="st">"ctsd"</span><span class="op">)</span>,</span>
<span>  subpop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_draws <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  iter_step <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rv">rv<a class="anchor" aria-label="anchor" href="#arg-rv"></a></dt>
<dd><p>A named list containing simulation inputs, settings, and
group assignments. Must not be NULL.</p></dd>


<dt id="arg-set-target">set_target<a class="anchor" aria-label="anchor" href="#arg-set-target"></a></dt>
<dd><p>Character vector specifying the target metrics.
Options are "hr" (for home range area) and/or "ctsd" (for movement
speed). Defaults to c("hr", "ctsd").</p></dd>


<dt id="arg-subpop">subpop<a class="anchor" aria-label="anchor" href="#arg-subpop"></a></dt>
<dd><p>Logical; if TRUE, analyzes population-level inferences
by subpopulations/groups (e.g., males vs. females). Requires group
assigments in <code>rv</code>.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>Logical; if TRUE, performs random sampling of individuals
using different combinations (up to max_draws).</p></dd>


<dt id="arg-max-draws">max_draws<a class="anchor" aria-label="anchor" href="#arg-max-draws"></a></dt>
<dd><p>Integer; maximum number of random draws per
combination size when <code>random=TRUE</code>.
Ignored if <code>random=FALSE</code>.</p></dd>


<dt id="arg-iter-step">iter_step<a class="anchor" aria-label="anchor" href="#arg-iter-step"></a></dt>
<dd><p>Integer. Step size used to increment the number of
individuals sampled in each iteration. For example, if
<code>iter_step = 2</code>, the function will evaluate sample sizes of 2, 4,
6, etc., up to the maximum population sample size. Defaults to 2.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>Logical; if TRUE, prints progress messages.
Default is FALSE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for advanced control:</p><dl><dt>.only_max_m</dt>
<dd><p>Logical. If <code>TRUE</code>, runs the meta-analysis
only at the maximum population sample size. Skips all
intermediate sample sizes.</p></dd>

<dt>.max_m</dt>
<dd><p>Integer. Sets a user-defined maximum sample size
to use in the resampling sequence. Overrides the default,
which uses all available individuals.</p></dd>

<dt>.m</dt>
<dd><p>Integer. Specifies exact sample size to use. Overrides
automatic sequence generation. Accepts a single value.</p></dd>

<dt>.automate_seq</dt>
<dd><p>Logical. If <code>TRUE</code>, automatically generates
an informative and non-redundant sequence of sample sizes
for better plot readability and runtime efficiency.</p></dd>

<dt>.lists</dt>
<dd><p>List (Optional). Supplies precomputed input
objects, generated via <code>.build_meta_objects()</code>.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame summarizing all outputs for each target,
population sample size, sample, and group (if specified). Columns
include:</p><dl><dt>type</dt>
<dd><p>Research target, e.g., "hr" or "ctsd".</p></dd>

<dt>m</dt>
<dd><p>Number of individuals in the sample.</p></dd>

<dt>sample</dt>
<dd><p>Sample index (for repeated draws).</p></dd>

<dt>truth</dt>
<dd><p>True value.</p></dd>

<dt>est</dt>
<dd><p>Point estimate.</p></dd>

<dt>lci</dt>
<dd><p>Lower confidence interval.</p></dd>

<dt>uci</dt>
<dd><p>Upper confidence interval.</p></dd>

<dt>error</dt>
<dd><p>Relative error.</p></dd>

<dt>error_lci</dt>
<dd><p>Lower CI for relative error.</p></dd>

<dt>error_uci</dt>
<dd><p>Upper CI for relative error.</p></dd>

<dt>ratio_truth</dt>
<dd><p>True group ratio (A/B), if subpop=TRUE.</p></dd>

<dt>ratio_est</dt>
<dd><p>Estimated group ratio.</p></dd>

<dt>ratio_lci</dt>
<dd><p>Lower CI for estimated group ratio.</p></dd>

<dt>ratio_uci</dt>
<dd><p>Upper CI for estimated group ratio.</p></dd>

<dt>overlaps</dt>
<dd><p>Logical; whether estimate overlaps with the truth.</p></dd>

<dt>is_grouped</dt>
<dd><p>Logical; TRUE if grouped.</p></dd>

<dt>group</dt>
<dd><p>Group label ("All", "A", "B").</p></dd>

<dt>subpop_detected</dt>
<dd><p>Logical; was a subpopulation detected?</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ctmm/man/akde.html" class="external-link">akde</a></code>, <code><a href="https://rdrr.io/pkg/ctmm/man/speed.html" class="external-link">speed</a></code>,</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Inês Silva <a href="mailto:i.simoes-silva@hzdr.de">i.simoes-silva@hzdr.de</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu">run_meta_resamples</span><span class="op">(</span><span class="va">rv</span>, set_target <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ecoisilva" class="external-link">Inês Silva</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

